import{r as ze,u as Re,c as re}from"./tabbar.vue_vue_type_script_setup_true_lang-7e4c637a.js";import{c as F,e as p,m as B,n as Z,M as Be,I as ee,p as H,w as V,t as z,u as G,N as $e,O as De,l as oe,P as Ye,i as ue,Q as _e,H as de,A as j,K as X,R as Ee,J as ve,T as ae,L as Xe,D as Ze,h as q,S as Ae,U as Le,E as He}from"./index-98350ca9.js";import{L as me,a as fe,u as ge,S as Me,b as Ne}from"./index-6a999e80.js";import{d as U,c as d,A as he,h as We,w as Y,a as D,T as ye,g as we,v as xe,b as W,n as Ie,o as Se,B as Fe,p as Ue,C as Ke,F as je,m as be,r as Pe}from"./index-f8123759.js";import{I as qe}from"./index-77fec029.js";let Ge=2e3;const Ve=()=>++Ge,[Je,A]=F("button"),Qe=p({},ze,{tag:B("button"),text:String,icon:String,type:B("default"),size:B("normal"),color:String,block:Boolean,plain:Boolean,round:Boolean,square:Boolean,loading:Boolean,hairline:Boolean,disabled:Boolean,iconPrefix:String,nativeType:B("button"),loadingSize:Z,loadingText:String,loadingType:String,iconPosition:B("left")});var pe=U({name:Je,props:Qe,emits:["click"],setup(e,{emit:a,slots:i}){const o=Re(),n=()=>i.loading?i.loading():d(me,{size:e.loadingSize,type:e.loadingType,class:A("loading")},null),f=()=>{if(e.loading)return n();if(i.icon)return d("div",{class:A("icon")},[i.icon()]);if(e.icon)return d(ee,{name:e.icon,class:A("icon"),classPrefix:e.iconPrefix},null)},g=()=>{let s;if(e.loading?s=e.loadingText:s=i.default?i.default():e.text,s)return d("span",{class:A("text")},[s])},m=()=>{const{color:s,plain:y}=e;if(s){const r={color:y?s:"white"};return y||(r.background=s),s.includes("gradient")?r.border=0:r.borderColor=s,r}},w=s=>{e.loading?H(s):e.disabled||(a("click",s),o())};return()=>{const{tag:s,type:y,size:r,block:x,round:I,plain:b,square:R,loading:h,disabled:T,hairline:c,nativeType:P,iconPosition:C}=e,_=[A([y,r,{plain:b,block:x,round:I,square:R,loading:h,disabled:T,hairline:c}]),{[Be]:c}];return d(s,{type:P,class:_,style:m(),disabled:T,onClick:w},{default:()=>[d("div",{class:A("content")},[C==="left"&&f(),g(),C==="right"&&f()])]})}}});const Po=V(pe),eo={show:Boolean,zIndex:Z,overlay:z,duration:Z,teleport:[String,Object],lockScroll:z,lazyRender:z,beforeClose:Function,overlayStyle:Object,overlayClass:G,transitionAppear:Boolean,closeOnClickOverlay:z};let N=0;const ie="van-overflow-hidden";function oo(e,a){const i=fe(),o="01",n="10",f=y=>{i.move(y);const r=i.deltaY.value>0?n:o,x=De(y.target,e.value),{scrollHeight:I,offsetHeight:b,scrollTop:R}=x;let h="11";R===0?h=b>=I?"00":"01":R+b>=I&&(h="10"),h!=="11"&&i.isVertical()&&!(parseInt(h,2)&parseInt(r,2))&&H(y,!0)},g=()=>{document.addEventListener("touchstart",i.start),document.addEventListener("touchmove",f,{passive:!1}),N||document.body.classList.add(ie),N++},m=()=>{N&&(document.removeEventListener("touchstart",i.start),document.removeEventListener("touchmove",f),N--,N||document.body.classList.remove(ie))},w=()=>a()&&g(),s=()=>a()&&m();$e(w),he(s),We(s),Y(a,y=>{y?g():m()})}function Ce(e){const a=D(!1);return Y(e,i=>{i&&(a.value=i)},{immediate:!0}),i=>()=>a.value?i():null}const[to,no]=F("overlay"),ao={show:Boolean,zIndex:Z,duration:Z,className:G,lockScroll:z,lazyRender:z,customStyle:Object};var io=U({name:to,props:ao,setup(e,{slots:a}){const i=D(),o=Ce(()=>e.show||!e.lazyRender),n=g=>{e.lockScroll&&H(g,!0)},f=o(()=>{var g;const m=p(Ye(e.zIndex),e.customStyle);return ue(e.duration)&&(m.animationDuration=`${e.duration}s`),we(d("div",{ref:i,style:m,class:[no(),e.className]},[(g=a.default)==null?void 0:g.call(a)]),[[xe,e.show]])});return oe("touchmove",n,{target:i}),()=>d(ye,{name:"van-fade",appear:!0},{default:f})}});const lo=V(io),so=p({},eo,{round:Boolean,position:B("center"),closeIcon:B("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:B("top-right"),safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[co,le]=F("popup");var ro=U({name:co,inheritAttrs:!1,props:so,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:a,attrs:i,slots:o}){let n,f;const g=D(),m=D(),w=Ce(()=>e.show||!e.lazyRender),s=W(()=>{const v={zIndex:g.value};if(ue(e.duration)){const k=e.position==="center"?"animationDuration":"transitionDuration";v[k]=`${e.duration}s`}return v}),y=()=>{n||(n=!0,g.value=e.zIndex!==void 0?+e.zIndex:Ve(),a("open"))},r=()=>{n&&re(e.beforeClose,{done(){n=!1,a("close"),a("update:show",!1)}})},x=v=>{a("clickOverlay",v),e.closeOnClickOverlay&&r()},I=()=>{if(e.overlay)return d(lo,{show:e.show,class:e.overlayClass,zIndex:g.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0,onClick:x},{default:o["overlay-content"]})},b=v=>{a("clickCloseIcon",v),r()},R=()=>{if(e.closeable)return d(ee,{role:"button",tabindex:0,name:e.closeIcon,class:[le("close-icon",e.closeIconPosition),de],classPrefix:e.iconPrefix,onClick:b},null)};let h;const T=()=>{h&&clearTimeout(h),h=setTimeout(()=>{a("opened")})},c=()=>a("closed"),P=v=>a("keydown",v),C=w(()=>{var v;const{round:k,position:E,safeAreaInsetTop:M,safeAreaInsetBottom:J}=e;return we(d("div",be({ref:m,style:s.value,role:"dialog",tabindex:0,class:[le({round:k,[E]:E}),{"van-safe-area-top":M,"van-safe-area-bottom":J}],onKeydown:P},i),[(v=o.default)==null?void 0:v.call(o),R()]),[[xe,e.show]])}),_=()=>{const{position:v,transition:k,transitionAppear:E}=e,M=v==="center"?"van-fade":`van-popup-slide-${v}`;return d(ye,{name:k||M,appear:E,onAfterEnter:T,onAfterLeave:c},{default:C})};return Y(()=>e.show,v=>{v&&!n&&(y(),i.tabindex===0&&Ie(()=>{var k;(k=m.value)==null||k.focus()})),!v&&n&&(n=!1,a("close"))}),ge({popupRef:m}),oo(m,()=>e.show&&e.lockScroll),oe("popstate",()=>{e.closeOnPopstate&&(r(),f=!1)}),Se(()=>{e.show&&y()}),Fe(()=>{f&&(a("update:show",!0),f=!1)}),he(()=>{e.show&&e.teleport&&(r(),f=!0)}),Ue(_e,()=>e.show),()=>e.teleport?d(Ke,{to:e.teleport},{default:()=>[I(),_()]}):d(je,null,[I(),_()])}});const uo=V(ro),se=e=>Math.sqrt((e[0].clientX-e[1].clientX)**2+(e[0].clientY-e[1].clientY)**2),vo=e=>({x:(e[0].clientX+e[1].clientX)/2,y:(e[0].clientY+e[1].clientY)/2}),Q=F("image-preview")[1],ce=2.6;var mo=U({props:{src:String,show:Boolean,active:Number,minZoom:j(Z),maxZoom:j(Z),rootWidth:j(Number),rootHeight:j(Number),disableZoom:Boolean,closeOnClickOverlay:Boolean},emits:["scale","close","longPress"],setup(e,{emit:a,slots:i}){const o=Pe({scale:1,moveX:0,moveY:0,moving:!1,zooming:!1,initializing:!1,imageRatio:0}),n=fe(),f=D(),g=D(),m=D(!1),w=D(!1);let s=0;const y=W(()=>{const{scale:t,moveX:l,moveY:u,moving:S,zooming:O,initializing:$}=o,K={transitionDuration:O||S||$?"0s":".3s"};return(t!==1||w.value)&&(K.transform=`matrix(${t}, 0, 0, ${t}, ${l}, ${u})`),K}),r=W(()=>{if(o.imageRatio){const{rootWidth:t,rootHeight:l}=e,u=m.value?l/o.imageRatio:t;return Math.max(0,(o.scale*u-t)/2)}return 0}),x=W(()=>{if(o.imageRatio){const{rootWidth:t,rootHeight:l}=e,u=m.value?l:t*o.imageRatio;return Math.max(0,(o.scale*u-l)/2)}return 0}),I=(t,l)=>{var u;if(t=X(t,+e.minZoom,+e.maxZoom+1),t!==o.scale){const S=t/o.scale;if(o.scale=t,l){const O=ve((u=f.value)==null?void 0:u.$el),$={x:O.width*.5,y:O.height*.5},K=o.moveX-(l.x-O.left-$.x)*(S-1),ke=o.moveY-(l.y-O.top-$.y)*(S-1);o.moveX=X(K,-r.value,r.value),o.moveY=X(ke,-x.value,x.value)}else o.moveX=0,o.moveY=w.value?s:0;a("scale",{scale:t,index:e.active})}},b=()=>{I(1)},R=()=>{const t=o.scale>1?1:2;I(t,t===2||w.value?{x:n.startX.value,y:n.startY.value}:void 0)};let h,T,c,P,C,_,v,k,E=!1;const M=t=>{const{touches:l}=t;if(h=l.length,h===2&&e.disableZoom)return;const{offsetX:u}=n;n.start(t),T=o.moveX,c=o.moveY,k=Date.now(),E=!1,o.moving=h===1&&(o.scale!==1||w.value),o.zooming=h===2&&!u.value,o.zooming&&(P=o.scale,C=se(l))},J=t=>{const{touches:l}=t;if(n.move(t),o.moving){const{deltaX:u,deltaY:S}=n,O=u.value+T,$=S.value+c;if((O>r.value||O<-r.value)&&!E&&n.isHorizontal()){o.moving=!1;return}E=!0,H(t,!0),o.moveX=X(O,-r.value,r.value),o.moveY=X($,-x.value,x.value)}if(o.zooming&&(H(t,!0),l.length===2)){const u=se(l),S=P*u/C;_=vo(l),I(S,_)}},Oe=t=>{var l;if(h>1)return;const{offsetX:u,offsetY:S}=n,O=Date.now()-k,$=250;if(u.value<ae&&S.value<ae)if(O<$)if(v)clearTimeout(v),v=null,R();else{if(!e.closeOnClickOverlay&&t.target===((l=g.value)==null?void 0:l.$el))return;v=setTimeout(()=>{a("close"),v=null},$)}else O>Xe&&a("longPress")},te=t=>{let l=!1;if((o.moving||o.zooming)&&(l=!0,o.moving&&T===o.moveX&&c===o.moveY&&(l=!1),!t.touches.length)){o.zooming&&(o.moveX=X(o.moveX,-r.value,r.value),o.moveY=X(o.moveY,-x.value,x.value),o.zooming=!1),o.moving=!1,T=0,c=0,P=1,o.scale<1&&b();const u=+e.maxZoom;o.scale>u&&I(u,_)}H(t,l),Oe(t),n.reset()},ne=()=>{const{rootWidth:t,rootHeight:l}=e,u=l/t,{imageRatio:S}=o;m.value=o.imageRatio>u&&S<ce,w.value=o.imageRatio>u&&S>=ce,w.value&&(s=(S*t-l)/2,o.moveY=s,o.initializing=!0,Ee(()=>{o.initializing=!1})),b()},Te=t=>{const{naturalWidth:l,naturalHeight:u}=t.target;o.imageRatio=u/l,ne()};return Y(()=>e.active,b),Y(()=>e.show,t=>{t||b()}),Y(()=>[e.rootWidth,e.rootHeight],ne),oe("touchmove",J,{target:W(()=>{var t;return(t=g.value)==null?void 0:t.$el})}),()=>{const t={loading:()=>d(me,{type:"spinner"},null)};return d(Me,{ref:g,class:Q("swipe-item"),onTouchstartPassive:M,onTouchend:te,onTouchcancel:te},{default:()=>[i.image?d("div",{class:Q("image-wrap")},[i.image({src:e.src})]):d(qe,{ref:f,src:e.src,fit:"contain",class:Q("image",{vertical:m.value}),style:y.value,onLoad:Te},t)]})}}});const[fo,L]=F("image-preview"),go=["show","teleport","transition","overlayStyle","closeOnPopstate"],ho={show:Boolean,loop:z,images:Ze(),minZoom:q(1/3),maxZoom:q(3),overlay:z,closeable:Boolean,showIndex:z,className:G,closeIcon:B("clear"),transition:String,beforeClose:Function,overlayClass:G,overlayStyle:Object,swipeDuration:q(300),startPosition:q(0),showIndicators:Boolean,closeOnPopstate:z,closeOnClickOverlay:z,closeIconPosition:B("top-right"),teleport:[String,Object]};var yo=U({name:fo,props:ho,emits:["scale","close","closed","change","longPress","update:show"],setup(e,{emit:a,slots:i}){const o=D(),n=Pe({active:0,rootWidth:0,rootHeight:0,disableZoom:!1}),f=()=>{if(o.value){const c=ve(o.value.$el);n.rootWidth=c.width,n.rootHeight=c.height,o.value.resize()}},g=c=>a("scale",c),m=c=>a("update:show",c),w=()=>{re(e.beforeClose,{args:[n.active],done:()=>m(!1)})},s=c=>{c!==n.active&&(n.active=c,a("change",c))},y=()=>{if(e.showIndex)return d("div",{class:L("index")},[i.index?i.index({index:n.active}):`${n.active+1} / ${e.images.length}`])},r=()=>{if(i.cover)return d("div",{class:L("cover")},[i.cover()])},x=()=>{n.disableZoom=!0},I=()=>{n.disableZoom=!1},b=()=>d(Ne,{ref:o,lazyRender:!0,loop:e.loop,class:L("swipe"),duration:e.swipeDuration,initialSwipe:e.startPosition,showIndicators:e.showIndicators,indicatorColor:"white",onChange:s,onDragEnd:I,onDragStart:x},{default:()=>[e.images.map((c,P)=>d(mo,{src:c,show:e.show,active:n.active,maxZoom:e.maxZoom,minZoom:e.minZoom,rootWidth:n.rootWidth,rootHeight:n.rootHeight,disableZoom:n.disableZoom,closeOnClickOverlay:e.closeOnClickOverlay,onScale:g,onClose:w,onLongPress:()=>a("longPress",{index:P})},{image:i.image}))]}),R=()=>{if(e.closeable)return d(ee,{role:"button",name:e.closeIcon,class:[L("close-icon",e.closeIconPosition),de],onClick:w},null)},h=()=>a("closed"),T=(c,P)=>{var C;return(C=o.value)==null?void 0:C.swipeTo(c,P)};return ge({swipeTo:T}),Se(f),Y([Ae,Le],f),Y(()=>e.startPosition,c=>s(+c)),Y(()=>e.show,c=>{const{images:P,startPosition:C}=e;c?(s(+C),Ie(()=>{f(),T(+C,{immediate:!0})})):a("close",{index:n.active,url:P[n.active]})}),()=>d(uo,be({class:[L(),e.className],overlayClass:[L("overlay"),e.overlayClass],onClosed:h,"onUpdate:show":m},He(e,go)),{default:()=>[R(),b(),y(),r()]})}});const Co=V(yo);export{Po as B,Co as I,yo as s};
