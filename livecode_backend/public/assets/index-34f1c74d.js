import{c as ne,m as G,n as z,t as p,u as fe,e as X,i as D,I as H,w as ae,a as Xe,p as Z,F as Te,g as Qe,s as et,b as tt,d as Ee,f as Re,h as J,j as nt,k as ve,C as at,l as lt,o as he,q as Ie,r as Fe,B as it,v as ot,x as Ve,y as Me,H as _e,z as rt,L as st,A as ut,D as ct,E as ue}from"./index-98350ca9.js";import{u as be,L as dt}from"./index-6a999e80.js";import{s as ft,B as mt}from"./index-be6cc127.js";import{I as gt}from"./index-77fec029.js";import{d as Y,c as o,r as ye,a as N,b as W,p as vt,w as me,n as le,o as ht,m as te,e as pe,f as bt,F as Ue,g as ie,v as oe,h as yt,u as wt,i as St,j as Q,t as we,k as It,l as Vt,_ as Ct}from"./index-f8123759.js";import{r as xt,u as _t,c as De,_ as Pt}from"./tabbar.vue_vue_type_script_setup_true_lang-7e4c637a.js";import{a as kt,u as Pe,b as Lt}from"./index-5403c250.js";import{u as At}from"./use-id-78052f00.js";const[Bt,ee]=ne("cell"),ze={tag:G("div"),icon:String,size:String,title:z,value:z,label:z,center:Boolean,isLink:Boolean,border:p,required:Boolean,iconPrefix:String,valueClass:fe,labelClass:fe,titleClass:fe,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},Tt=X({},ze,xt);var Et=Y({name:Bt,props:Tt,setup(e,{slots:t}){const l=_t(),u=()=>{if(t.label||D(e.label))return o("div",{class:[ee("label"),e.labelClass]},[t.label?t.label():e.label])},r=()=>{var m;if(t.title||D(e.title)){const I=(m=t.title)==null?void 0:m.call(t);return Array.isArray(I)&&I.length===0?void 0:o("div",{class:[ee("title"),e.titleClass],style:e.titleStyle},[I||o("span",null,[e.title]),u()])}},c=()=>{const m=t.value||t.default;if(m||D(e.value))return o("div",{class:[ee("value"),e.valueClass]},[m?m():o("span",null,[e.value])])},w=()=>{if(t.icon)return t.icon();if(e.icon)return o(H,{name:e.icon,class:ee("left-icon"),classPrefix:e.iconPrefix},null)},k=()=>{if(t["right-icon"])return t["right-icon"]();if(e.isLink){const m=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return o(H,{name:m,class:ee("right-icon")},null)}};return()=>{var m;const{tag:I,size:a,center:y,border:h,isLink:b,required:C}=e,R=(m=e.clickable)!=null?m:b,d={center:y,required:C,clickable:R,borderless:!h};return a&&(d[a]=!!a),o(I,{class:ee(d),role:R?"button":void 0,tabindex:R?0:void 0,onClick:l},{default:()=>{var f;return[w(),r(),c(),k(),(f=t.extra)==null?void 0:f.call(t)]}})}}});const Rt=ae(Et),[Ft,Mt]=ne("form"),pt={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:z,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:p,showErrorMessage:p,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var Ut=Y({name:Ft,props:pt,emits:["submit","failed"],setup(e,{emit:t,slots:l}){const{children:u,linkChildren:r}=Xe(Te),c=d=>d?u.filter(f=>d.includes(f.name)):u,w=d=>new Promise((f,P)=>{const L=[];c(d).reduce(($,s)=>$.then(()=>{if(!L.length)return s.validate().then(g=>{g&&L.push(g)})}),Promise.resolve()).then(()=>{L.length?P(L):f()})}),k=d=>new Promise((f,P)=>{const L=c(d);Promise.all(L.map(T=>T.validate())).then(T=>{T=T.filter(Boolean),T.length?P(T):f()})}),m=d=>{const f=u.find(P=>P.name===d);return f?new Promise((P,L)=>{f.validate().then(T=>{T?L(T):P()})}):Promise.reject()},I=d=>typeof d=="string"?m(d):e.validateFirst?w(d):k(d),a=d=>{typeof d=="string"&&(d=[d]),c(d).forEach(P=>{P.resetValidation()})},y=()=>u.reduce((d,f)=>(d[f.name]=f.getValidationStatus(),d),{}),h=(d,f)=>{u.some(P=>P.name===d?(P.$el.scrollIntoView(f),!0):!1)},b=()=>u.reduce((d,f)=>(f.name!==void 0&&(d[f.name]=f.formValue.value),d),{}),C=()=>{const d=b();I().then(()=>t("submit",d)).catch(f=>{t("failed",{values:d,errors:f}),e.scrollToError&&f[0].name&&h(f[0].name)})},R=d=>{Z(d),C()};return r({props:e}),be({submit:C,validate:I,getValues:b,scrollToField:h,resetValidation:a,getValidationStatus:y}),()=>{var d;return o("form",{class:Mt(),onSubmit:R},[(d=l.default)==null?void 0:d.call(l)])}}});const Dt=ae(Ut);function $e(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function zt(e,t){if($e(e)){if(t.required)return!1;if(t.validateEmpty===!1)return!0}return!(t.pattern&&!t.pattern.test(String(e)))}function $t(e,t){return new Promise(l=>{const u=t.validator(e,t);if(Ee(u)){u.then(l);return}l(u)})}function ke(e,t){const{message:l}=t;return Re(l)?l(e,t):l||""}function Ot({target:e}){e.composing=!0}function Le({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function Nt(e,t){const l=Qe();e.style.height="auto";let u=e.scrollHeight;if(tt(t)){const{maxHeight:r,minHeight:c}=t;r!==void 0&&(u=Math.min(u,r)),c!==void 0&&(u=Math.max(u,c))}u&&(e.style.height=`${u}px`,et(l))}function jt(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function q(e){return[...e].length}function Se(e,t){return[...e].slice(0,t).join("")}const[qt,U]=ne("field"),Wt={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:z,formatter:Function,clearIcon:G("clear"),modelValue:J(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,spellcheck:{type:Boolean,default:null},clearTrigger:G("focus"),formatTrigger:G("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},Gt=X({},ze,Wt,{rows:z,type:G("text"),rules:Array,autosize:[Boolean,Object],labelWidth:z,labelClass:fe,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Ht=Y({name:qt,props:Gt,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:l}){const u=At(),r=ye({status:"unvalidated",focused:!1,validateMessage:""}),c=N(),w=N(),k=N(),{parent:m}=nt(Te),I=()=>{var n;return String((n=e.modelValue)!=null?n:"")},a=n=>{if(D(e[n]))return e[n];if(m&&D(m.props[n]))return m.props[n]},y=W(()=>{const n=a("readonly");if(e.clearable&&!n){const V=I()!=="",S=e.clearTrigger==="always"||e.clearTrigger==="focus"&&r.focused;return V&&S}return!1}),h=W(()=>k.value&&l.input?k.value():e.modelValue),b=n=>n.reduce((V,S)=>V.then(()=>{if(r.status==="failed")return;let{value:_}=h;if(S.formatter&&(_=S.formatter(_,S)),!zt(_,S)){r.status="failed",r.validateMessage=ke(_,S);return}if(S.validator)return $e(_)&&S.validateEmpty===!1?void 0:$t(_,S).then(B=>{B&&typeof B=="string"?(r.status="failed",r.validateMessage=B):B===!1&&(r.status="failed",r.validateMessage=ke(_,S))})}),Promise.resolve()),C=()=>{r.status="unvalidated",r.validateMessage=""},R=()=>t("endValidate",{status:r.status,message:r.validateMessage}),d=(n=e.rules)=>new Promise(V=>{C(),n?(t("startValidate"),b(n).then(()=>{r.status==="failed"?(V({name:e.name,message:r.validateMessage}),R()):(r.status="passed",V(),R())})):V()}),f=n=>{if(m&&e.rules){const{validateTrigger:V}=m.props,S=he(V).includes(n),_=e.rules.filter(B=>B.trigger?he(B.trigger).includes(n):S);_.length&&d(_)}},P=n=>{var V;const{maxlength:S}=e;if(D(S)&&q(n)>+S){const _=I();if(_&&q(_)===+S)return _;const B=(V=c.value)==null?void 0:V.selectionEnd;if(r.focused&&B){const M=[...n],O=M.length-+S;return M.splice(B-O,O),M.join("")}return Se(n,+S)}return n},L=(n,V="onChange")=>{const S=n;n=P(n);const _=q(S)-q(n);if(e.type==="number"||e.type==="digit"){const M=e.type==="number";n=Ie(n,M,M)}let B=0;if(e.formatter&&V===e.formatTrigger){const{formatter:M,maxlength:O}=e;if(n=M(n),D(O)&&q(n)>+O&&(n=Se(n,+O)),c.value&&r.focused){const{selectionEnd:se}=c.value,xe=Se(S,se);B=q(M(xe))-q(xe)}}if(c.value&&c.value.value!==n)if(r.focused){let{selectionStart:M,selectionEnd:O}=c.value;if(c.value.value=n,D(M)&&D(O)){const se=q(n);_?(M-=_,O-=_):B&&(M+=B,O+=B),c.value.setSelectionRange(Math.min(M,se),Math.min(O,se))}}else c.value.value=n;n!==e.modelValue&&t("update:modelValue",n)},T=n=>{n.target.composing||L(n.target.value)},$=()=>{var n;return(n=c.value)==null?void 0:n.blur()},s=()=>{var n;return(n=c.value)==null?void 0:n.focus()},g=()=>{const n=c.value;e.type==="textarea"&&e.autosize&&n&&Nt(n,e.autosize)},i=n=>{r.focused=!0,t("focus",n),le(g),a("readonly")&&$()},v=n=>{r.focused=!1,L(I(),"onBlur"),t("blur",n),!a("readonly")&&(f("onBlur"),le(g),Fe())},x=n=>t("clickInput",n),F=n=>t("clickLeftIcon",n),E=n=>t("clickRightIcon",n),j=n=>{Z(n),t("update:modelValue",""),t("clear",n)},K=W(()=>{if(typeof e.error=="boolean")return e.error;if(m&&m.props.showError&&r.status==="failed")return!0}),re=W(()=>{const n=a("labelWidth"),V=a("labelAlign");if(n&&V!=="top")return{width:ve(n)}}),je=n=>{n.keyCode===13&&(!(m&&m.props.submitOnEnter)&&e.type!=="textarea"&&Z(n),e.type==="search"&&$()),t("keypress",n)},Ce=()=>e.id||`${u}-input`,qe=()=>r.status,We=()=>{const n=U("control",[a("inputAlign"),{error:K.value,custom:!!l.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(l.input)return o("div",{class:n,onClick:x},[l.input()]);const V={id:Ce(),ref:c,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:n,disabled:a("disabled"),readonly:a("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${u}-label`:void 0,onBlur:v,onFocus:i,onInput:T,onClick:x,onChange:Le,onKeypress:je,onCompositionend:Le,onCompositionstart:Ot};return e.type==="textarea"?o("textarea",V,null):o("input",te(jt(e.type),V),null)},Ge=()=>{const n=l["left-icon"];if(e.leftIcon||n)return o("div",{class:U("left-icon"),onClick:F},[n?n():o(H,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},He=()=>{const n=l["right-icon"];if(e.rightIcon||n)return o("div",{class:U("right-icon"),onClick:E},[n?n():o(H,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Ke=()=>{if(e.showWordLimit&&e.maxlength){const n=q(I());return o("div",{class:U("word-limit")},[o("span",{class:U("word-num")},[n]),pe("/"),e.maxlength])}},Je=()=>{if(m&&m.props.showErrorMessage===!1)return;const n=e.errorMessage||r.validateMessage;if(n){const V=l["error-message"],S=a("errorMessageAlign");return o("div",{class:U("error-message",S)},[V?V({message:n}):n])}},Ye=()=>{const n=a("labelWidth"),V=a("labelAlign"),S=a("colon")?":":"";if(l.label)return[l.label(),S];if(e.label)return o("label",{id:`${u}-label`,for:l.input?void 0:Ce(),onClick:_=>{Z(_),s()},style:V==="top"&&n?{width:ve(n)}:void 0},[e.label+S])},Ze=()=>[o("div",{class:U("body")},[We(),y.value&&o(H,{ref:w,name:e.clearIcon,class:U("clear")},null),He(),l.button&&o("div",{class:U("button")},[l.button()])]),Ke(),Je()];return be({blur:$,focus:s,validate:d,formValue:h,resetValidation:C,getValidationStatus:qe}),vt(at,{customValue:k,resetValidation:C,validateWithTrigger:f}),me(()=>e.modelValue,()=>{L(I()),C(),f("onChange"),le(g)}),ht(()=>{L(I(),e.formatTrigger),le(g)}),lt("touchstart",j,{target:W(()=>{var n;return(n=w.value)==null?void 0:n.$el})}),()=>{const n=a("disabled"),V=a("labelAlign"),S=Ge(),_=()=>{const B=Ye();return V==="top"?[S,B].filter(Boolean):B||[]};return o(Rt,{size:e.size,class:U({error:K.value,disabled:n,[`label-${V}`]:V}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:re.value,valueClass:U("value"),titleClass:[U("label",[V,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:S&&V!=="top"?()=>S:null,title:_,value:Ze,extra:l.extra})}}});const Kt=ae(Ht);function Jt(){const e=ye({show:!1}),t=r=>{e.show=r},l=r=>{X(e,r,{transitionAppear:!0}),t(!0)},u=()=>t(!1);return be({open:l,close:u,toggle:t}),{open:l,close:u,state:e,toggle:t}}function Yt(e){const t=bt(e),l=document.createElement("div");return document.body.appendChild(l),{instance:t.mount(l),unmount(){t.unmount(),document.body.removeChild(l)}}}const[Zt,Ae]=ne("cell-group"),Xt={title:String,inset:Boolean,border:p};var Qt=Y({name:Zt,inheritAttrs:!1,props:Xt,setup(e,{slots:t,attrs:l}){const u=()=>{var c;return o("div",te({class:[Ae({inset:e.inset}),{[it]:e.border&&!e.inset}]},l),[(c=t.default)==null?void 0:c.call(t)])},r=()=>o("div",{class:Ae("title",{inset:e.inset})},[t.title?t.title():e.title]);return()=>e.title||t.title?o(Ue,null,[r(),u()]):u()}});const en=ae(Qt);let ge;const tn={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function nn(){({instance:ge}=Yt({setup(){const{state:e,toggle:t}=Jt(),l=()=>{e.images=[]};return()=>o(ft,te(e,{onClosed:l,"onUpdate:show":t}),null)}}))}const an=(e,t=0)=>{if(ot)return ge||nn(),e=Array.isArray(e)?{images:e,startPosition:t}:e,ge.open(X({},tn,e)),ge},[ln,ce]=ne("stepper"),on=200,de=(e,t)=>String(e)===String(t),rn={min:J(1),max:J(1/0),name:J(""),step:J(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:p,showMinus:p,showInput:p,longPress:p,autoFixed:p,allowEmpty:Boolean,modelValue:z,inputWidth:z,buttonSize:z,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:J(1),decimalLength:z};var sn=Y({name:ln,props:rn,emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,{emit:t}){const l=(i,v=!0)=>{const{min:x,max:F,allowEmpty:E,decimalLength:j}=e;return E&&i===""||(i=Ie(String(i),!e.integer),i=i===""?0:+i,i=Number.isNaN(i)?+x:i,i=v?Math.max(Math.min(+F,i),+x):i,D(j)&&(i=i.toFixed(+j))),i},u=()=>{var i;const v=(i=e.modelValue)!=null?i:e.defaultValue,x=l(v);return de(x,e.modelValue)||t("update:modelValue",x),x};let r;const c=N(),w=N(u()),k=W(()=>e.disabled||e.disableMinus||+w.value<=+e.min),m=W(()=>e.disabled||e.disablePlus||+w.value>=+e.max),I=W(()=>({width:ve(e.inputWidth),height:ve(e.buttonSize)})),a=W(()=>Ve(e.buttonSize)),y=()=>{const i=l(w.value);de(i,w.value)||(w.value=i)},h=i=>{e.beforeChange?De(e.beforeChange,{args:[i],done(){w.value=i}}):w.value=i},b=()=>{if(r==="plus"&&m.value||r==="minus"&&k.value){t("overlimit",r);return}const i=r==="minus"?-e.step:+e.step,v=l(rt(+w.value,i));h(v),t(r)},C=i=>{const v=i.target,{value:x}=v,{decimalLength:F}=e;let E=Ie(String(x),!e.integer);if(D(F)&&E.includes(".")){const K=E.split(".");E=`${K[0]}.${K[1].slice(0,+F)}`}e.beforeChange?v.value=String(w.value):de(x,E)||(v.value=E);const j=E===String(+E);h(j?+E:E)},R=i=>{var v;e.disableInput?(v=c.value)==null||v.blur():t("focus",i)},d=i=>{const v=i.target,x=l(v.value,e.autoFixed);v.value=String(x),w.value=x,le(()=>{t("blur",i),Fe()})};let f,P;const L=()=>{P=setTimeout(()=>{b(),L()},on)},T=()=>{e.longPress&&(f=!1,clearTimeout(P),P=setTimeout(()=>{f=!0,b(),L()},st))},$=i=>{e.longPress&&(clearTimeout(P),f&&Z(i))},s=i=>{e.disableInput&&Z(i)},g=i=>({onClick:v=>{Z(v),r=i,b()},onTouchstartPassive:()=>{r=i,T()},onTouchend:$,onTouchcancel:$});return me(()=>[e.max,e.min,e.integer,e.decimalLength],y),me(()=>e.modelValue,i=>{de(i,w.value)||(w.value=l(i))}),me(w,i=>{t("update:modelValue",i),t("change",i,{name:e.name})}),Me(()=>e.modelValue),()=>o("div",{role:"group",class:ce([e.theme])},[ie(o("button",te({type:"button",style:a.value,class:[ce("minus",{disabled:k.value}),{[_e]:!k.value}],"aria-disabled":k.value||void 0},g("minus")),null),[[oe,e.showMinus]]),ie(o("input",{ref:c,type:e.integer?"tel":"text",role:"spinbutton",class:ce("input"),value:w.value,style:I.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,"aria-valuemax":e.max,"aria-valuemin":e.min,"aria-valuenow":w.value,onBlur:d,onInput:C,onFocus:R,onMousedown:s},null),[[oe,e.showInput]]),ie(o("button",te({type:"button",style:a.value,class:[ce("plus",{disabled:m.value}),{[_e]:!m.value}],"aria-disabled":m.value||void 0},g("plus")),null),[[oe,e.showPlus]])])}});const un=ae(sn),[cn,A,dn]=ne("uploader");function Be(e,t){return new Promise(l=>{if(t==="file"){l();return}const u=new FileReader;u.onload=r=>{l(r.target.result)},t==="dataUrl"?u.readAsDataURL(e):t==="text"&&u.readAsText(e)})}function Oe(e,t){return he(e).some(l=>l.file?Re(t)?t(l.file):l.file.size>+t:!1)}function fn(e,t){const l=[],u=[];return e.forEach(r=>{Oe(r,t)?u.push(r):l.push(r)}),{valid:l,invalid:u}}const mn=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,gn=e=>mn.test(e);function Ne(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?gn(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var vn=Y({props:{name:z,item:ut(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:t,slots:l}){const u=()=>{const{status:a,message:y}=e.item;if(a==="uploading"||a==="failed"){const h=a==="failed"?o(H,{name:"close",class:A("mask-icon")},null):o(dt,{class:A("loading")},null),b=D(y)&&y!=="";return o("div",{class:A("mask")},[h,b&&o("div",{class:A("mask-message")},[y])])}},r=a=>{const{name:y,item:h,index:b,beforeDelete:C}=e;a.stopPropagation(),De(C,{args:[h,{name:y,index:b}],done:()=>t("delete")})},c=()=>t("preview"),w=()=>t("reupload"),k=()=>{if(e.deletable&&e.item.status!=="uploading"){const a=l["preview-delete"];return o("div",{role:"button",class:A("preview-delete",{shadow:!a}),tabindex:0,"aria-label":dn("delete"),onClick:r},[a?a():o(H,{name:"cross",class:A("preview-delete-icon")},null)])}},m=()=>{if(l["preview-cover"]){const{index:a,item:y}=e;return o("div",{class:A("preview-cover")},[l["preview-cover"](X({index:a},y))])}},I=()=>{const{item:a,lazyLoad:y,imageFit:h,previewSize:b,reupload:C}=e;return Ne(a)?o(gt,{fit:h,src:a.objectUrl||a.content||a.url,class:A("preview-image"),width:Array.isArray(b)?b[0]:b,height:Array.isArray(b)?b[1]:b,lazyLoad:y,onClick:C?w:c},{default:m}):o("div",{class:A("file"),style:Ve(e.previewSize)},[o(H,{class:A("file-icon"),name:"description"},null),o("div",{class:[A("file-name"),"van-ellipsis"]},[a.file?a.file.name:a.url]),m()])};return()=>o("div",{class:A("preview")},[I(),u(),k()])}});const hn={name:J(""),accept:G("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:J(1/0),imageFit:G("cover"),resultType:G("dataUrl"),uploadIcon:G("photograph"),uploadText:String,deletable:p,reupload:Boolean,afterRead:Function,showUpload:p,modelValue:ct(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:p,previewOptions:Object,previewFullImage:p,maxSize:{type:[Number,String,Function],default:1/0}};var bn=Y({name:cn,props:hn,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:t,slots:l}){const u=N(),r=[],c=N(-1),w=(s=e.modelValue.length)=>({name:e.name,index:s}),k=()=>{u.value&&(u.value.value="")},m=s=>{if(k(),Oe(s,e.maxSize))if(Array.isArray(s)){const g=fn(s,e.maxSize);if(s=g.valid,t("oversize",g.invalid,w()),!s.length)return}else{t("oversize",s,w());return}if(s=ye(s),c.value>-1){const g=[...e.modelValue];g.splice(c.value,1,s),t("update:modelValue",g),c.value=-1}else t("update:modelValue",[...e.modelValue,...he(s)]);e.afterRead&&e.afterRead(s,w())},I=s=>{const{maxCount:g,modelValue:i,resultType:v}=e;if(Array.isArray(s)){const x=+g-i.length;s.length>x&&(s=s.slice(0,x)),Promise.all(s.map(F=>Be(F,v))).then(F=>{const E=s.map((j,K)=>{const re={file:j,status:"",message:"",objectUrl:URL.createObjectURL(j)};return F[K]&&(re.content=F[K]),re});m(E)})}else Be(s,v).then(x=>{const F={file:s,status:"",message:"",objectUrl:URL.createObjectURL(s)};x&&(F.content=x),m(F)})},a=s=>{const{files:g}=s.target;if(e.disabled||!g||!g.length)return;const i=g.length===1?g[0]:[].slice.call(g);if(e.beforeRead){const v=e.beforeRead(i,w());if(!v){k();return}if(Ee(v)){v.then(x=>{I(x||i)}).catch(k);return}}I(i)};let y;const h=()=>t("closePreview"),b=s=>{if(e.previewFullImage){const g=e.modelValue.filter(Ne),i=g.map(v=>(v.objectUrl&&!v.url&&v.status!=="failed"&&(v.url=v.objectUrl,r.push(v.url)),v.url)).filter(Boolean);y=an(X({images:i,startPosition:g.indexOf(s),onClose:h},e.previewOptions))}},C=()=>{y&&y.close()},R=(s,g)=>{const i=e.modelValue.slice(0);i.splice(g,1),t("update:modelValue",i),t("delete",s,w(g))},d=s=>{$(),c.value=s},f=(s,g)=>{const i=["imageFit","deletable","reupload","previewSize","beforeDelete"],v=X(ue(e,i),ue(s,i,!0));return o(vn,te({item:s,index:g,onClick:()=>t(e.reupload?"clickReupload":"clickPreview",s,w(g)),onDelete:()=>R(s,g),onPreview:()=>b(s),onReupload:()=>d(g)},ue(e,["name","lazyLoad"]),v),ue(l,["preview-cover","preview-delete"]))},P=()=>{if(e.previewImage)return e.modelValue.map(f)},L=s=>t("clickUpload",s),T=()=>{if(e.modelValue.length>=+e.maxCount&&!e.reupload)return;const s=e.modelValue.length>=+e.maxCount&&e.reupload,g=e.readonly?null:o("input",{ref:u,type:"file",class:A("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&c.value===-1,disabled:e.disabled,onChange:a},null);return l.default?ie(o("div",{class:A("input-wrapper"),onClick:L},[l.default(),g]),[[oe,!s]]):ie(o("div",{class:A("upload",{readonly:e.readonly}),style:Ve(e.previewSize),onClick:L},[o(H,{name:e.uploadIcon,class:A("upload-icon")},null),e.uploadText&&o("span",{class:A("upload-text")},[e.uploadText]),g]),[[oe,e.showUpload&&!s]])},$=()=>{u.value&&!e.disabled&&u.value.click()};return yt(()=>{r.forEach(s=>URL.revokeObjectURL(s))}),be({chooseFile:$,closeImagePreview:C}),Me(()=>e.modelValue),()=>o("div",{class:A()},[o("div",{class:A("wrapper",{disabled:e.disabled})},[P(),T()])])}});const yn=ae(bn);const wn={style:{margin:"16px"}},Sn=Y({__name:"index",setup(e){const t=wt(),l=N(!1),u=N(),r=N(),c=ye({codeTitle:"",codeDescription:"",childrenIds:[],changeValue:1,logoUrl:""}),w=async I=>{let a=we(I);const y=async h=>{let b=await Pe(h);if(b){let C=await Lt(b);C&&c.childrenIds.push(C)}};if(typeof a=="object"&&a!==null&&"objectUrl"in a){let h=a.file;h&&await y(h)}Array.isArray(a)&&a.forEach(async h=>{let b=h.file;b&&await y(b)})},k=async I=>{let a=we(I);const y=async h=>{let b=await Pe(h);c.logoUrl=b};if(typeof a=="object"&&a!==null&&"objectUrl"in a){let h=a.file;h&&await y(h)}},m=async()=>{let{codeTitle:I,codeDescription:a,childrenIds:y,logoUrl:h,changeValue:b}=c,C=JSON.stringify(we(y));await kt(I,a,C,h,b),t.push("/mycode")};return(I,a)=>{const y=Kt,h=yn,b=un,C=en,R=mt,d=Dt;return It(),St(Ue,null,[o(d,{onSubmit:m,class:"form"},{default:Q(()=>[o(C,{inset:""},{default:Q(()=>[o(y,{modelValue:c.codeTitle,"onUpdate:modelValue":a[0]||(a[0]=f=>c.codeTitle=f),name:"codeTitle",placeholder:"请输入活码标题",rules:[{required:!0,message:"请填写活码标题!!!!"}]},null,8,["modelValue"]),o(y,{modelValue:c.codeDescription,"onUpdate:modelValue":a[1]||(a[1]=f=>c.codeDescription=f),name:"description",placeholder:"请简单描写活码，防止忘记用途",rules:[{required:!0,message:"请描写活码用途"}]},null,8,["modelValue"]),o(y,{name:"uploader",label:"添加子码二维码",rules:[{required:!0,message:"请上传活码!!!!"}]},{input:Q(()=>[o(h,{"after-read":w,multiple:"",modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=f=>u.value=f)},null,8,["modelValue"])]),_:1}),o(y,{name:"stepper",label:"子码切换阈值"},{input:Q(()=>[o(b,{modelValue:c.changeValue,"onUpdate:modelValue":a[3]||(a[3]=f=>c.changeValue=f)},null,8,["modelValue"])]),_:1}),o(y,{name:"uploader",label:"上传logo",rules:[{required:!0,message:"请上传logo"}]},{input:Q(()=>[o(h,{"after-read":k,multiple:"","max-count":1,modelValue:r.value,"onUpdate:modelValue":a[4]||(a[4]=f=>r.value=f)},null,8,["modelValue"])]),_:1})]),_:1}),Vt("div",wn,[o(R,{"loading-text":"活码生成中...",loading:l.value,round:"",block:"",type:"primary","native-type":"submit"},{default:Q(()=>[pe("生成二维码活码")]),_:1},8,["loading"])])]),_:1}),o(Pt,{active:0})],64)}}});const An=Ct(Sn,[["__scopeId","data-v-4ecd4739"]]);export{An as default};
