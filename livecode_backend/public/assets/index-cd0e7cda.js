import{c as ne,m as G,n as z,t as p,u as fe,e as Q,i as D,I as H,w as ae,a as Xe,p as X,F as Be,g as Qe,s as et,b as tt,d as Ee,f as Re,h as J,j as nt,k as ve,C as at,l as lt,o as he,q as Ie,r as Fe,B as it,v as ot,x as Ve,y as Me,H as _e,z as rt,L as st,A as ut,D as ct,E as ue}from"./index-c28695b9.js";import{u as be,L as dt}from"./index-fa22e3aa.js";import{s as ft,B as mt}from"./index-496b1ef7.js";import{I as gt}from"./index-e9f2f527.js";import{d as Y,c as l,r as ye,a as j,b as W,p as vt,w as me,n as le,o as ht,m as te,e as pe,f as bt,F as Ue,g as ie,v as oe,h as yt,u as wt,i as St,j as Z,t as we,k as It,_ as Vt}from"./index-46928ffb.js";import{r as Ct,u as xt,c as De,_ as _t}from"./tabbar.vue_vue_type_script_setup_true_lang-c7bd155c.js";import{a as Pt,u as Pe,b as kt}from"./index-de31b9a3.js";import{u as Lt}from"./use-id-a94015ea.js";const[At,ee]=ne("cell"),ze={tag:G("div"),icon:String,size:String,title:z,value:z,label:z,center:Boolean,isLink:Boolean,border:p,required:Boolean,iconPrefix:String,valueClass:fe,labelClass:fe,titleClass:fe,titleStyle:null,arrowDirection:String,clickable:{type:Boolean,default:null}},Tt=Q({},ze,Ct);var Bt=Y({name:At,props:Tt,setup(e,{slots:t}){const i=xt(),u=()=>{if(t.label||D(e.label))return l("div",{class:[ee("label"),e.labelClass]},[t.label?t.label():e.label])},r=()=>{var m;if(t.title||D(e.title)){const I=(m=t.title)==null?void 0:m.call(t);return Array.isArray(I)&&I.length===0?void 0:l("div",{class:[ee("title"),e.titleClass],style:e.titleStyle},[I||l("span",null,[e.title]),u()])}},c=()=>{const m=t.value||t.default;if(m||D(e.value))return l("div",{class:[ee("value"),e.valueClass]},[m?m():l("span",null,[e.value])])},w=()=>{if(t.icon)return t.icon();if(e.icon)return l(H,{name:e.icon,class:ee("left-icon"),classPrefix:e.iconPrefix},null)},k=()=>{if(t["right-icon"])return t["right-icon"]();if(e.isLink){const m=e.arrowDirection&&e.arrowDirection!=="right"?`arrow-${e.arrowDirection}`:"arrow";return l(H,{name:m,class:ee("right-icon")},null)}};return()=>{var m;const{tag:I,size:a,center:h,border:b,isLink:y,required:C}=e,R=(m=e.clickable)!=null?m:y,d={center:h,required:C,clickable:R,borderless:!b};return a&&(d[a]=!!a),l(I,{class:ee(d),role:R?"button":void 0,tabindex:R?0:void 0,onClick:i},{default:()=>{var f;return[w(),r(),c(),k(),(f=t.extra)==null?void 0:f.call(t)]}})}}});const Et=ae(Bt),[Rt,Ft]=ne("form"),Mt={colon:Boolean,disabled:Boolean,readonly:Boolean,showError:Boolean,labelWidth:z,labelAlign:String,inputAlign:String,scrollToError:Boolean,validateFirst:Boolean,submitOnEnter:p,showErrorMessage:p,errorMessageAlign:String,validateTrigger:{type:[String,Array],default:"onBlur"}};var pt=Y({name:Rt,props:Mt,emits:["submit","failed"],setup(e,{emit:t,slots:i}){const{children:u,linkChildren:r}=Xe(Be),c=d=>d?u.filter(f=>d.includes(f.name)):u,w=d=>new Promise((f,P)=>{const L=[];c(d).reduce(($,s)=>$.then(()=>{if(!L.length)return s.validate().then(g=>{g&&L.push(g)})}),Promise.resolve()).then(()=>{L.length?P(L):f()})}),k=d=>new Promise((f,P)=>{const L=c(d);Promise.all(L.map(B=>B.validate())).then(B=>{B=B.filter(Boolean),B.length?P(B):f()})}),m=d=>{const f=u.find(P=>P.name===d);return f?new Promise((P,L)=>{f.validate().then(B=>{B?L(B):P()})}):Promise.reject()},I=d=>typeof d=="string"?m(d):e.validateFirst?w(d):k(d),a=d=>{typeof d=="string"&&(d=[d]),c(d).forEach(P=>{P.resetValidation()})},h=()=>u.reduce((d,f)=>(d[f.name]=f.getValidationStatus(),d),{}),b=(d,f)=>{u.some(P=>P.name===d?(P.$el.scrollIntoView(f),!0):!1)},y=()=>u.reduce((d,f)=>(f.name!==void 0&&(d[f.name]=f.formValue.value),d),{}),C=()=>{const d=y();I().then(()=>t("submit",d)).catch(f=>{t("failed",{values:d,errors:f}),e.scrollToError&&f[0].name&&b(f[0].name)})},R=d=>{X(d),C()};return r({props:e}),be({submit:C,validate:I,getValues:y,scrollToField:b,resetValidation:a,getValidationStatus:h}),()=>{var d;return l("form",{class:Ft(),onSubmit:R},[(d=i.default)==null?void 0:d.call(i)])}}});const Ut=ae(pt);function $e(e){return Array.isArray(e)?!e.length:e===0?!1:!e}function Dt(e,t){if($e(e)){if(t.required)return!1;if(t.validateEmpty===!1)return!0}return!(t.pattern&&!t.pattern.test(String(e)))}function zt(e,t){return new Promise(i=>{const u=t.validator(e,t);if(Ee(u)){u.then(i);return}i(u)})}function ke(e,t){const{message:i}=t;return Re(i)?i(e,t):i||""}function $t({target:e}){e.composing=!0}function Le({target:e}){e.composing&&(e.composing=!1,e.dispatchEvent(new Event("input")))}function Ot(e,t){const i=Qe();e.style.height="auto";let u=e.scrollHeight;if(tt(t)){const{maxHeight:r,minHeight:c}=t;r!==void 0&&(u=Math.min(u,r)),c!==void 0&&(u=Math.max(u,c))}u&&(e.style.height=`${u}px`,et(i))}function jt(e){return e==="number"?{type:"text",inputmode:"decimal"}:e==="digit"?{type:"tel",inputmode:"numeric"}:{type:e}}function q(e){return[...e].length}function Se(e,t){return[...e].slice(0,t).join("")}const[Nt,U]=ne("field"),qt={id:String,name:String,leftIcon:String,rightIcon:String,autofocus:Boolean,clearable:Boolean,maxlength:z,formatter:Function,clearIcon:G("clear"),modelValue:J(""),inputAlign:String,placeholder:String,autocomplete:String,autocapitalize:String,autocorrect:String,errorMessage:String,enterkeyhint:String,spellcheck:{type:Boolean,default:null},clearTrigger:G("focus"),formatTrigger:G("onChange"),error:{type:Boolean,default:null},disabled:{type:Boolean,default:null},readonly:{type:Boolean,default:null}},Wt=Q({},ze,qt,{rows:z,type:G("text"),rules:Array,autosize:[Boolean,Object],labelWidth:z,labelClass:fe,labelAlign:String,showWordLimit:Boolean,errorMessageAlign:String,colon:{type:Boolean,default:null}});var Gt=Y({name:Nt,props:Wt,emits:["blur","focus","clear","keypress","clickInput","endValidate","startValidate","clickLeftIcon","clickRightIcon","update:modelValue"],setup(e,{emit:t,slots:i}){const u=Lt(),r=ye({status:"unvalidated",focused:!1,validateMessage:""}),c=j(),w=j(),k=j(),{parent:m}=nt(Be),I=()=>{var n;return String((n=e.modelValue)!=null?n:"")},a=n=>{if(D(e[n]))return e[n];if(m&&D(m.props[n]))return m.props[n]},h=W(()=>{const n=a("readonly");if(e.clearable&&!n){const V=I()!=="",S=e.clearTrigger==="always"||e.clearTrigger==="focus"&&r.focused;return V&&S}return!1}),b=W(()=>k.value&&i.input?k.value():e.modelValue),y=n=>n.reduce((V,S)=>V.then(()=>{if(r.status==="failed")return;let{value:_}=b;if(S.formatter&&(_=S.formatter(_,S)),!Dt(_,S)){r.status="failed",r.validateMessage=ke(_,S);return}if(S.validator)return $e(_)&&S.validateEmpty===!1?void 0:zt(_,S).then(T=>{T&&typeof T=="string"?(r.status="failed",r.validateMessage=T):T===!1&&(r.status="failed",r.validateMessage=ke(_,S))})}),Promise.resolve()),C=()=>{r.status="unvalidated",r.validateMessage=""},R=()=>t("endValidate",{status:r.status,message:r.validateMessage}),d=(n=e.rules)=>new Promise(V=>{C(),n?(t("startValidate"),y(n).then(()=>{r.status==="failed"?(V({name:e.name,message:r.validateMessage}),R()):(r.status="passed",V(),R())})):V()}),f=n=>{if(m&&e.rules){const{validateTrigger:V}=m.props,S=he(V).includes(n),_=e.rules.filter(T=>T.trigger?he(T.trigger).includes(n):S);_.length&&d(_)}},P=n=>{var V;const{maxlength:S}=e;if(D(S)&&q(n)>+S){const _=I();if(_&&q(_)===+S)return _;const T=(V=c.value)==null?void 0:V.selectionEnd;if(r.focused&&T){const M=[...n],O=M.length-+S;return M.splice(T-O,O),M.join("")}return Se(n,+S)}return n},L=(n,V="onChange")=>{const S=n;n=P(n);const _=q(S)-q(n);if(e.type==="number"||e.type==="digit"){const M=e.type==="number";n=Ie(n,M,M)}let T=0;if(e.formatter&&V===e.formatTrigger){const{formatter:M,maxlength:O}=e;if(n=M(n),D(O)&&q(n)>+O&&(n=Se(n,+O)),c.value&&r.focused){const{selectionEnd:se}=c.value,xe=Se(S,se);T=q(M(xe))-q(xe)}}if(c.value&&c.value.value!==n)if(r.focused){let{selectionStart:M,selectionEnd:O}=c.value;if(c.value.value=n,D(M)&&D(O)){const se=q(n);_?(M-=_,O-=_):T&&(M+=T,O+=T),c.value.setSelectionRange(Math.min(M,se),Math.min(O,se))}}else c.value.value=n;n!==e.modelValue&&t("update:modelValue",n)},B=n=>{n.target.composing||L(n.target.value)},$=()=>{var n;return(n=c.value)==null?void 0:n.blur()},s=()=>{var n;return(n=c.value)==null?void 0:n.focus()},g=()=>{const n=c.value;e.type==="textarea"&&e.autosize&&n&&Ot(n,e.autosize)},o=n=>{r.focused=!0,t("focus",n),le(g),a("readonly")&&$()},v=n=>{r.focused=!1,L(I(),"onBlur"),t("blur",n),!a("readonly")&&(f("onBlur"),le(g),Fe())},x=n=>t("clickInput",n),F=n=>t("clickLeftIcon",n),E=n=>t("clickRightIcon",n),N=n=>{X(n),t("update:modelValue",""),t("clear",n)},K=W(()=>{if(typeof e.error=="boolean")return e.error;if(m&&m.props.showError&&r.status==="failed")return!0}),re=W(()=>{const n=a("labelWidth"),V=a("labelAlign");if(n&&V!=="top")return{width:ve(n)}}),Ne=n=>{n.keyCode===13&&(!(m&&m.props.submitOnEnter)&&e.type!=="textarea"&&X(n),e.type==="search"&&$()),t("keypress",n)},Ce=()=>e.id||`${u}-input`,qe=()=>r.status,We=()=>{const n=U("control",[a("inputAlign"),{error:K.value,custom:!!i.input,"min-height":e.type==="textarea"&&!e.autosize}]);if(i.input)return l("div",{class:n,onClick:x},[i.input()]);const V={id:Ce(),ref:c,name:e.name,rows:e.rows!==void 0?+e.rows:void 0,class:n,disabled:a("disabled"),readonly:a("readonly"),autofocus:e.autofocus,placeholder:e.placeholder,autocomplete:e.autocomplete,autocapitalize:e.autocapitalize,autocorrect:e.autocorrect,enterkeyhint:e.enterkeyhint,spellcheck:e.spellcheck,"aria-labelledby":e.label?`${u}-label`:void 0,onBlur:v,onFocus:o,onInput:B,onClick:x,onChange:Le,onKeypress:Ne,onCompositionend:Le,onCompositionstart:$t};return e.type==="textarea"?l("textarea",V,null):l("input",te(jt(e.type),V),null)},Ge=()=>{const n=i["left-icon"];if(e.leftIcon||n)return l("div",{class:U("left-icon"),onClick:F},[n?n():l(H,{name:e.leftIcon,classPrefix:e.iconPrefix},null)])},He=()=>{const n=i["right-icon"];if(e.rightIcon||n)return l("div",{class:U("right-icon"),onClick:E},[n?n():l(H,{name:e.rightIcon,classPrefix:e.iconPrefix},null)])},Ke=()=>{if(e.showWordLimit&&e.maxlength){const n=q(I());return l("div",{class:U("word-limit")},[l("span",{class:U("word-num")},[n]),pe("/"),e.maxlength])}},Je=()=>{if(m&&m.props.showErrorMessage===!1)return;const n=e.errorMessage||r.validateMessage;if(n){const V=i["error-message"],S=a("errorMessageAlign");return l("div",{class:U("error-message",S)},[V?V({message:n}):n])}},Ye=()=>{const n=a("labelWidth"),V=a("labelAlign"),S=a("colon")?":":"";if(i.label)return[i.label(),S];if(e.label)return l("label",{id:`${u}-label`,for:i.input?void 0:Ce(),onClick:_=>{X(_),s()},style:V==="top"&&n?{width:ve(n)}:void 0},[e.label+S])},Ze=()=>[l("div",{class:U("body")},[We(),h.value&&l(H,{ref:w,name:e.clearIcon,class:U("clear")},null),He(),i.button&&l("div",{class:U("button")},[i.button()])]),Ke(),Je()];return be({blur:$,focus:s,validate:d,formValue:b,resetValidation:C,getValidationStatus:qe}),vt(at,{customValue:k,resetValidation:C,validateWithTrigger:f}),me(()=>e.modelValue,()=>{L(I()),C(),f("onChange"),le(g)}),ht(()=>{L(I(),e.formatTrigger),le(g)}),lt("touchstart",N,{target:W(()=>{var n;return(n=w.value)==null?void 0:n.$el})}),()=>{const n=a("disabled"),V=a("labelAlign"),S=Ge(),_=()=>{const T=Ye();return V==="top"?[S,T].filter(Boolean):T||[]};return l(Et,{size:e.size,class:U({error:K.value,disabled:n,[`label-${V}`]:V}),center:e.center,border:e.border,isLink:e.isLink,clickable:e.clickable,titleStyle:re.value,valueClass:U("value"),titleClass:[U("label",[V,{required:e.required}]),e.labelClass],arrowDirection:e.arrowDirection},{icon:S&&V!=="top"?()=>S:null,title:_,value:Ze,extra:i.extra})}}});const Ht=ae(Gt);function Kt(){const e=ye({show:!1}),t=r=>{e.show=r},i=r=>{Q(e,r,{transitionAppear:!0}),t(!0)},u=()=>t(!1);return be({open:i,close:u,toggle:t}),{open:i,close:u,state:e,toggle:t}}function Jt(e){const t=bt(e),i=document.createElement("div");return document.body.appendChild(i),{instance:t.mount(i),unmount(){t.unmount(),document.body.removeChild(i)}}}const[Yt,Ae]=ne("cell-group"),Zt={title:String,inset:Boolean,border:p};var Xt=Y({name:Yt,inheritAttrs:!1,props:Zt,setup(e,{slots:t,attrs:i}){const u=()=>{var c;return l("div",te({class:[Ae({inset:e.inset}),{[it]:e.border&&!e.inset}]},i),[(c=t.default)==null?void 0:c.call(t)])},r=()=>l("div",{class:Ae("title",{inset:e.inset})},[t.title?t.title():e.title]);return()=>e.title||t.title?l(Ue,null,[r(),u()]):u()}});const Qt=ae(Xt);let ge;const en={loop:!0,images:[],maxZoom:3,minZoom:1/3,onScale:void 0,onClose:void 0,onChange:void 0,teleport:"body",className:"",showIndex:!0,closeable:!1,closeIcon:"clear",transition:void 0,beforeClose:void 0,overlayStyle:void 0,overlayClass:void 0,startPosition:0,swipeDuration:300,showIndicators:!1,closeOnPopstate:!0,closeOnClickOverlay:!0,closeIconPosition:"top-right"};function tn(){({instance:ge}=Jt({setup(){const{state:e,toggle:t}=Kt(),i=()=>{e.images=[]};return()=>l(ft,te(e,{onClosed:i,"onUpdate:show":t}),null)}}))}const nn=(e,t=0)=>{if(ot)return ge||tn(),e=Array.isArray(e)?{images:e,startPosition:t}:e,ge.open(Q({},en,e)),ge},[an,ce]=ne("stepper"),ln=200,de=(e,t)=>String(e)===String(t),on={min:J(1),max:J(1/0),name:J(""),step:J(1),theme:String,integer:Boolean,disabled:Boolean,showPlus:p,showMinus:p,showInput:p,longPress:p,autoFixed:p,allowEmpty:Boolean,modelValue:z,inputWidth:z,buttonSize:z,placeholder:String,disablePlus:Boolean,disableMinus:Boolean,disableInput:Boolean,beforeChange:Function,defaultValue:J(1),decimalLength:z};var rn=Y({name:an,props:on,emits:["plus","blur","minus","focus","change","overlimit","update:modelValue"],setup(e,{emit:t}){const i=(o,v=!0)=>{const{min:x,max:F,allowEmpty:E,decimalLength:N}=e;return E&&o===""||(o=Ie(String(o),!e.integer),o=o===""?0:+o,o=Number.isNaN(o)?+x:o,o=v?Math.max(Math.min(+F,o),+x):o,D(N)&&(o=o.toFixed(+N))),o},u=()=>{var o;const v=(o=e.modelValue)!=null?o:e.defaultValue,x=i(v);return de(x,e.modelValue)||t("update:modelValue",x),x};let r;const c=j(),w=j(u()),k=W(()=>e.disabled||e.disableMinus||+w.value<=+e.min),m=W(()=>e.disabled||e.disablePlus||+w.value>=+e.max),I=W(()=>({width:ve(e.inputWidth),height:ve(e.buttonSize)})),a=W(()=>Ve(e.buttonSize)),h=()=>{const o=i(w.value);de(o,w.value)||(w.value=o)},b=o=>{e.beforeChange?De(e.beforeChange,{args:[o],done(){w.value=o}}):w.value=o},y=()=>{if(r==="plus"&&m.value||r==="minus"&&k.value){t("overlimit",r);return}const o=r==="minus"?-e.step:+e.step,v=i(rt(+w.value,o));b(v),t(r)},C=o=>{const v=o.target,{value:x}=v,{decimalLength:F}=e;let E=Ie(String(x),!e.integer);if(D(F)&&E.includes(".")){const K=E.split(".");E=`${K[0]}.${K[1].slice(0,+F)}`}e.beforeChange?v.value=String(w.value):de(x,E)||(v.value=E);const N=E===String(+E);b(N?+E:E)},R=o=>{var v;e.disableInput?(v=c.value)==null||v.blur():t("focus",o)},d=o=>{const v=o.target,x=i(v.value,e.autoFixed);v.value=String(x),w.value=x,le(()=>{t("blur",o),Fe()})};let f,P;const L=()=>{P=setTimeout(()=>{y(),L()},ln)},B=()=>{e.longPress&&(f=!1,clearTimeout(P),P=setTimeout(()=>{f=!0,y(),L()},st))},$=o=>{e.longPress&&(clearTimeout(P),f&&X(o))},s=o=>{e.disableInput&&X(o)},g=o=>({onClick:v=>{X(v),r=o,y()},onTouchstartPassive:()=>{r=o,B()},onTouchend:$,onTouchcancel:$});return me(()=>[e.max,e.min,e.integer,e.decimalLength],h),me(()=>e.modelValue,o=>{de(o,w.value)||(w.value=i(o))}),me(w,o=>{t("update:modelValue",o),t("change",o,{name:e.name})}),Me(()=>e.modelValue),()=>l("div",{role:"group",class:ce([e.theme])},[ie(l("button",te({type:"button",style:a.value,class:[ce("minus",{disabled:k.value}),{[_e]:!k.value}],"aria-disabled":k.value||void 0},g("minus")),null),[[oe,e.showMinus]]),ie(l("input",{ref:c,type:e.integer?"tel":"text",role:"spinbutton",class:ce("input"),value:w.value,style:I.value,disabled:e.disabled,readonly:e.disableInput,inputmode:e.integer?"numeric":"decimal",placeholder:e.placeholder,"aria-valuemax":e.max,"aria-valuemin":e.min,"aria-valuenow":w.value,onBlur:d,onInput:C,onFocus:R,onMousedown:s},null),[[oe,e.showInput]]),ie(l("button",te({type:"button",style:a.value,class:[ce("plus",{disabled:m.value}),{[_e]:!m.value}],"aria-disabled":m.value||void 0},g("plus")),null),[[oe,e.showPlus]])])}});const sn=ae(rn),[un,A,cn]=ne("uploader");function Te(e,t){return new Promise(i=>{if(t==="file"){i();return}const u=new FileReader;u.onload=r=>{i(r.target.result)},t==="dataUrl"?u.readAsDataURL(e):t==="text"&&u.readAsText(e)})}function Oe(e,t){return he(e).some(i=>i.file?Re(t)?t(i.file):i.file.size>+t:!1)}function dn(e,t){const i=[],u=[];return e.forEach(r=>{Oe(r,t)?u.push(r):i.push(r)}),{valid:i,invalid:u}}const fn=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|avif)/i,mn=e=>fn.test(e);function je(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?mn(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var gn=Y({props:{name:z,item:ut(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,reupload:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview","reupload"],setup(e,{emit:t,slots:i}){const u=()=>{const{status:a,message:h}=e.item;if(a==="uploading"||a==="failed"){const b=a==="failed"?l(H,{name:"close",class:A("mask-icon")},null):l(dt,{class:A("loading")},null),y=D(h)&&h!=="";return l("div",{class:A("mask")},[b,y&&l("div",{class:A("mask-message")},[h])])}},r=a=>{const{name:h,item:b,index:y,beforeDelete:C}=e;a.stopPropagation(),De(C,{args:[b,{name:h,index:y}],done:()=>t("delete")})},c=()=>t("preview"),w=()=>t("reupload"),k=()=>{if(e.deletable&&e.item.status!=="uploading"){const a=i["preview-delete"];return l("div",{role:"button",class:A("preview-delete",{shadow:!a}),tabindex:0,"aria-label":cn("delete"),onClick:r},[a?a():l(H,{name:"cross",class:A("preview-delete-icon")},null)])}},m=()=>{if(i["preview-cover"]){const{index:a,item:h}=e;return l("div",{class:A("preview-cover")},[i["preview-cover"](Q({index:a},h))])}},I=()=>{const{item:a,lazyLoad:h,imageFit:b,previewSize:y,reupload:C}=e;return je(a)?l(gt,{fit:b,src:a.objectUrl||a.content||a.url,class:A("preview-image"),width:Array.isArray(y)?y[0]:y,height:Array.isArray(y)?y[1]:y,lazyLoad:h,onClick:C?w:c},{default:m}):l("div",{class:A("file"),style:Ve(e.previewSize)},[l(H,{class:A("file-icon"),name:"description"},null),l("div",{class:[A("file-name"),"van-ellipsis"]},[a.file?a.file.name:a.url]),m()])};return()=>l("div",{class:A("preview")},[I(),u(),k()])}});const vn={name:J(""),accept:G("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:J(1/0),imageFit:G("cover"),resultType:G("dataUrl"),uploadIcon:G("photograph"),uploadText:String,deletable:p,reupload:Boolean,afterRead:Function,showUpload:p,modelValue:ct(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:p,previewOptions:Object,previewFullImage:p,maxSize:{type:[Number,String,Function],default:1/0}};var hn=Y({name:un,props:vn,emits:["delete","oversize","clickUpload","closePreview","clickPreview","clickReupload","update:modelValue"],setup(e,{emit:t,slots:i}){const u=j(),r=[],c=j(-1),w=(s=e.modelValue.length)=>({name:e.name,index:s}),k=()=>{u.value&&(u.value.value="")},m=s=>{if(k(),Oe(s,e.maxSize))if(Array.isArray(s)){const g=dn(s,e.maxSize);if(s=g.valid,t("oversize",g.invalid,w()),!s.length)return}else{t("oversize",s,w());return}if(s=ye(s),c.value>-1){const g=[...e.modelValue];g.splice(c.value,1,s),t("update:modelValue",g),c.value=-1}else t("update:modelValue",[...e.modelValue,...he(s)]);e.afterRead&&e.afterRead(s,w())},I=s=>{const{maxCount:g,modelValue:o,resultType:v}=e;if(Array.isArray(s)){const x=+g-o.length;s.length>x&&(s=s.slice(0,x)),Promise.all(s.map(F=>Te(F,v))).then(F=>{const E=s.map((N,K)=>{const re={file:N,status:"",message:"",objectUrl:URL.createObjectURL(N)};return F[K]&&(re.content=F[K]),re});m(E)})}else Te(s,v).then(x=>{const F={file:s,status:"",message:"",objectUrl:URL.createObjectURL(s)};x&&(F.content=x),m(F)})},a=s=>{const{files:g}=s.target;if(e.disabled||!g||!g.length)return;const o=g.length===1?g[0]:[].slice.call(g);if(e.beforeRead){const v=e.beforeRead(o,w());if(!v){k();return}if(Ee(v)){v.then(x=>{I(x||o)}).catch(k);return}}I(o)};let h;const b=()=>t("closePreview"),y=s=>{if(e.previewFullImage){const g=e.modelValue.filter(je),o=g.map(v=>(v.objectUrl&&!v.url&&v.status!=="failed"&&(v.url=v.objectUrl,r.push(v.url)),v.url)).filter(Boolean);h=nn(Q({images:o,startPosition:g.indexOf(s),onClose:b},e.previewOptions))}},C=()=>{h&&h.close()},R=(s,g)=>{const o=e.modelValue.slice(0);o.splice(g,1),t("update:modelValue",o),t("delete",s,w(g))},d=s=>{$(),c.value=s},f=(s,g)=>{const o=["imageFit","deletable","reupload","previewSize","beforeDelete"],v=Q(ue(e,o),ue(s,o,!0));return l(gn,te({item:s,index:g,onClick:()=>t(e.reupload?"clickReupload":"clickPreview",s,w(g)),onDelete:()=>R(s,g),onPreview:()=>y(s),onReupload:()=>d(g)},ue(e,["name","lazyLoad"]),v),ue(i,["preview-cover","preview-delete"]))},P=()=>{if(e.previewImage)return e.modelValue.map(f)},L=s=>t("clickUpload",s),B=()=>{if(e.modelValue.length>=+e.maxCount&&!e.reupload)return;const s=e.modelValue.length>=+e.maxCount&&e.reupload,g=e.readonly?null:l("input",{ref:u,type:"file",class:A("input"),accept:e.accept,capture:e.capture,multiple:e.multiple&&c.value===-1,disabled:e.disabled,onChange:a},null);return i.default?ie(l("div",{class:A("input-wrapper"),onClick:L},[i.default(),g]),[[oe,!s]]):ie(l("div",{class:A("upload",{readonly:e.readonly}),style:Ve(e.previewSize),onClick:L},[l(H,{name:e.uploadIcon,class:A("upload-icon")},null),e.uploadText&&l("span",{class:A("upload-text")},[e.uploadText]),g]),[[oe,e.showUpload&&!s]])},$=()=>{u.value&&!e.disabled&&u.value.click()};return yt(()=>{r.forEach(s=>URL.revokeObjectURL(s))}),be({chooseFile:$,closeImagePreview:C}),Me(()=>e.modelValue),()=>l("div",{class:A()},[l("div",{class:A("wrapper",{disabled:e.disabled})},[P(),B()])])}});const bn=ae(hn);const yn=Y({__name:"index",setup(e){const t=wt(),i=j(!1),u=j(),r=j(),c=ye({codeTitle:"",codeDescription:"",childrenIds:[],changeValue:1,logoUrl:""}),w=async I=>{let a=we(I);const h=async b=>{let y=await Pe(b);if(y){let C=await kt(y);C&&c.childrenIds.push(C)}};if(typeof a=="object"&&a!==null&&"objectUrl"in a){let b=a.file;b&&await h(b)}Array.isArray(a)&&a.forEach(async b=>{let y=b.file;y&&await h(y)})},k=async I=>{let a=we(I);const h=async b=>{let y=await Pe(b);c.logoUrl=y};if(typeof a=="object"&&a!==null&&"objectUrl"in a){let b=a.file;b&&await h(b)}},m=async()=>{let{codeTitle:I,codeDescription:a,childrenIds:h,logoUrl:b,changeValue:y}=c,C=JSON.stringify(we(h));await Pt(I,a,C,b,y),t.push("/mycode")};return(I,a)=>{const h=Ht,b=bn,y=sn,C=mt,R=Qt,d=Ut;return It(),St(Ue,null,[l(d,{onSubmit:m,class:"form"},{default:Z(()=>[l(R,{inset:""},{default:Z(()=>[l(h,{modelValue:c.codeTitle,"onUpdate:modelValue":a[0]||(a[0]=f=>c.codeTitle=f),name:"codeTitle",placeholder:"请输入活码标题",rules:[{required:!0,message:"请填写活码标题!!!!"}]},null,8,["modelValue"]),l(h,{modelValue:c.codeDescription,"onUpdate:modelValue":a[1]||(a[1]=f=>c.codeDescription=f),name:"description",placeholder:"请简单描写活码，防止忘记用途",rules:[{required:!0,message:"请描写活码用途"}]},null,8,["modelValue"]),l(h,{name:"uploader",label:"添加子码二维码",rules:[{required:!0,message:"请上传活码!!!!"}]},{input:Z(()=>[l(b,{"after-read":w,multiple:"",modelValue:u.value,"onUpdate:modelValue":a[2]||(a[2]=f=>u.value=f)},null,8,["modelValue"])]),_:1}),l(h,{name:"stepper",label:"子码切换阈值"},{input:Z(()=>[l(y,{modelValue:c.changeValue,"onUpdate:modelValue":a[3]||(a[3]=f=>c.changeValue=f)},null,8,["modelValue"])]),_:1}),l(h,{name:"uploader",label:"上传logo",rules:[{required:!0,message:"请上传logo"}]},{input:Z(()=>[l(b,{"after-read":k,multiple:"","max-count":1,modelValue:r.value,"onUpdate:modelValue":a[4]||(a[4]=f=>r.value=f)},null,8,["modelValue"])]),_:1}),l(h,null,{input:Z(()=>[l(C,{"loading-text":"活码生成中...",loading:i.value,round:"",block:"",type:"primary","native-type":"submit"},{default:Z(()=>[pe("生成二维码活码")]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1}),l(_t,{active:0})],64)}}});const kn=Vt(yn,[["__scopeId","data-v-d04ed9c3"]]);export{kn as default};
